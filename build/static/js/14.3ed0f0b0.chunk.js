(this["webpackJsonptus-tramites-administrador"]=this["webpackJsonptus-tramites-administrador"]||[]).push([[14],{199:function(e,t,a){"use strict";a(0);var i=a(71),n=a(215),s=a(1);t.a=e=>{let{title:t="Nuevo Tr\xe1mite"}=e;return Object(s.jsxs)("div",{className:"content-add-tramite",children:[Object(s.jsx)("div",{className:"button-nuevo-tramite",children:Object(s.jsxs)("div",{className:"centrarVerHor",children:[Object(s.jsx)(i.q,{}),Object(s.jsx)("span",{children:t})]})}),Object(s.jsx)("div",{className:"input-tramite",children:Object(s.jsx)("div",{className:"notificacion-movil",children:Object(s.jsx)(n.a,{})})})]})}},216:function(e,t,a){"use strict";a(0);var i=a(480),n=a(1);t.a=e=>{let{columns:t,data:a,pagination:s}=e;return Object(n.jsx)(i.a,{columns:t,dataSource:a,pagination:s})}},220:function(e,t,a){"use strict";a(0);var i=a(449),n=a(238),s=a(237),c=a(468),l=a(1);t.a=e=>{let{handleSee:t,handleEdit:a,handleDelete:r}=e;return Object(l.jsxs)(i.a,{size:"middle",children:[t?Object(l.jsxs)("span",{className:"action-edit",onClick:t,children:[Object(l.jsx)(n.a,{}),"Ver"]}):null,a?Object(l.jsxs)("span",{className:"action-edit",onClick:a,children:[Object(l.jsx)(s.a,{}),"Editar"]}):null,r?Object(l.jsxs)("span",{className:"action-edit",onClick:r,children:[Object(l.jsx)(c.a,{}),"Eliminar"]}):null]})}},224:function(e,t,a){},237:function(e,t,a){"use strict";var i=a(2),n=a(0),s=a(226),c=a(73),l=function(e,t){return n.createElement(c.a,Object(i.a)(Object(i.a)({},e),{},{ref:t,icon:s.a}))},r=n.forwardRef(l);t.a=r},238:function(e,t,a){"use strict";var i=a(2),n=a(0),s=a(225),c=a(73),l=function(e,t){return n.createElement(c.a,Object(i.a)(Object(i.a)({},e),{},{ref:t,icon:s.a}))},r=n.forwardRef(l);t.a=r},439:function(e,t,a){},440:function(e,t,a){},498:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a(68),s=a(213),c=a(216),l=a(220),r=a(443),o=a(74),d=a(233),u=a.n(d),j=(a(267),a(328)),m=a(483),b=a(229),O=a(444),_=(a(439),a(188)),x=a(1);const{Option:h}=j.a;var p=e=>{let{notification:t,data:a,setData:s,callback:c}=e;const[l]=m.a.useForm(),{user:d}=Object(i.useContext)(o.a),[p,f]=Object(i.useState)(void 0),[g,v]=Object(i.useState)(void 0),[S,k]=Object(i.useState)([]),[w,E]=Object(i.useState)({}),[C,A]=Object(i.useState)([]),[N,T]=Object(i.useState)({}),F=()=>{let e="ASESOR LEGAL"===w.role?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_URL_CLIENT+"/procedure":"";N&&(e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_URL_CLIENT,e="2"===N.state?e+"/notarialactsteptwo?id="+N.notarialAct._id+"&p="+N._id:"3"===N.state?e+"/notarialactstepthree?id="+N.notarialAct._id+"&p="+N._id:"4"===N.state?e+"/notarialactstepfour?id="+N.notarialAct._id+"&p="+N._id:"6"===N.state||"7"===N.state?e+"/ordersummary?p="+N._id:"8"===N.state||"9"===N.state?e+"/documentresult?p="+N._id:"11"===N.state||"13"===N.state?e+"/date?p="+N._id:""),t?n.a.put("/api/notification-new/update/"+t._id,{title:l.getFieldValue("title"),message:l.getFieldValue("message"),created_at:t.created_at,view:t.view,_from:d.id,_to:l.getFieldValue("_to"),text:l.getFieldValue("text")||"",link:l.getFieldValue("text")?e:""}).then((e=>{s(null),c()})):n.a.post("/api/notification-new",{title:l.getFieldValue("title"),message:l.getFieldValue("message"),created_at:new Date,view:!1,_from:d.id,_to:l.getFieldValue("_to"),text:l.getFieldValue("text")||"",link:l.getFieldValue("text")?e:""}).then((e=>{s(null),c()}))},L=()=>{s(null)},y=async e=>{const t=await n.a.get("/api/procedurenotarial/"+e);200==t.status&&A(t.data)};return Object(i.useEffect)((()=>{if((async()=>{const e=await n.a.get("/api/user");200==e.status&&k(e.data.filter((e=>"CLIENTE"===e.role)))})(),l.resetFields(),t){let e={title:t.title,message:t.message,_to:t._to,text:t.text,link:t.link};l.setFieldsValue(e),f(t._to);let a=S.find((e=>e._id===t._to));if(a&&(E(a),y(t._to)),t.link&&""!==t.link){const e=/id=([^&]+)/,a=/p=([^&]+)/,i=(t.link.match(e),t.link.match(a));let n=C.find((e=>e._id===i));n&&T(n)}}}),[t,a]),Object(x.jsxs)(r.a,{open:a,onOk:F,onCancel:L,forceRender:!0,maskClosable:!1,closeIcon:Object(x.jsx)("span",{className:"containerButtonX",onClick:L,children:Object(x.jsx)(_.a,{})}),footer:[Object(x.jsx)(b.a,{className:"btnContinuar",type:"primary",onClick:F,children:"Aceptar"},"submit")],children:[Object(x.jsx)("h3",{children:"Informaci\xf3n de la notificaci\xf3n"}),Object(x.jsx)(m.a,{layout:"vertical",form:l,children:Object(x.jsxs)("div",{className:"form-control",children:[Object(x.jsx)(m.a.Item,{label:"Titulo",name:"title",id:"title",hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese el titulo!"},{min:3,message:"El titulo debe tener al menos 3 caracteres!"}],children:Object(x.jsx)(O.a,{})}),Object(x.jsx)(m.a.Item,{label:"Mensaje",name:"message",id:"message",hasFeedback:!0,rules:[{required:!0,message:"Por favor ingrese el mensaje!"},{min:3,message:"El mensaje debe tener al menos 3 caracteres!"}],children:Object(x.jsx)(O.a,{})}),Object(x.jsx)(m.a.Item,{name:"_to",id:"_to",label:"Asignado a:",rules:[{required:!0}],children:Object(x.jsx)(j.a,{showSearch:!0,value:p,defaultValue:p,placeholder:"Selecciones un usuario",defaultActiveFirstOption:!1,showArrow:!1,onChange:e=>{f(e);let t=S.find((t=>t._id===e));t&&(E(t),v(void 0),T({}),A([]),y(e))},filterOption:(e,t)=>t.children.toLowerCase().indexOf(e.toLowerCase())>=0,children:S.map((e=>Object(x.jsx)(h,{value:e._id,children:e.first_name+" "+e.last_name},e._id)))})}),C.length>0&&Object(x.jsx)(m.a.Item,{name:"procedure",id:"procedure",label:"Acto notarial",children:Object(x.jsx)(j.a,{showSearch:!0,value:g,defaultValue:g,placeholder:"Selecciones un acto notarial",defaultActiveFirstOption:!1,showArrow:!1,onChange:e=>{v(e);let t=C.find((t=>t._id===e));t&&T(t)},filterOption:(e,t)=>t.children.toLowerCase().indexOf(e.toLowerCase())>=0,children:C.map((e=>Object(x.jsx)(h,{value:e._id,children:u()(e.date).locale("es").format("LL")+" - "+e.notarialAct.name},e._id)))})}),Object(x.jsx)(m.a.Item,{label:"Texto del bot\xf3n",name:"text",id:"text",hasFeedback:!0,rules:[{min:3,message:"El texto debe tener al menos 3 caracteres!"},{max:25,message:"El texto debe tener m\xe1ximo 25 caracteres!"}],children:Object(x.jsx)(O.a,{})})]})})]})},f=(a(224),a(199)),g=a(70);a(440);t.default=()=>{const[e,t]=Object(i.useState)(!1),[a,r]=Object(i.useState)([]),[o,d]=Object(i.useState)(),[j,m]=Object(i.useState)(void 0),O=[{title:"Titulo",dataIndex:"title",key:"title",render:e=>Object(x.jsx)("span",{children:e})},{title:"Fecha",dataIndex:"created_at",key:"created_at",render:e=>Object(x.jsx)("span",{children:e})},{title:"Asignado a",dataIndex:"_to_complete",key:"_to_complete",render:e=>Object(x.jsx)("span",{children:e&&e.first_name&&e.last_name?e.first_name+" "+e.last_name:"Sin asignar"})},{title:"Acto notarial",dataIndex:"procedure_notarial",key:"procedure_notarial",render:e=>Object(x.jsx)("span",{children:e})},{title:"Estado",dataIndex:"view",key:"view",render:e=>Object(x.jsx)("span",{children:e?"Le\xeddo":"No le\xeddo"})},{title:"Acci\xf3n",dataIndex:"action",key:"action",render:(e,t)=>Object(x.jsx)(l.a,{handleDelete:()=>_(t)})}],_=e=>{g.a.show({type:"error",title:"",message:"\xbfSeguro desea eliminar esta notificaci\xf3n?",btnOk:"Aceptar",fnOk:()=>{h(e)},btnCancel:"Cancelar",buttonX:!0})},h=async e=>{200==(await n.a.delete("/api/notification-new/"+e._id)).status&&v()},v=async()=>{let e=[],t=[];const a=await n.a.get("/api/notification-new/all?type=0");200==a.status&&(e=[...a.data]);const i=await n.a.get("/api/user");200==i.status&&(t=[...i.data]);let s=[];if(e.length>0)for await(var c of e){let e=t.find((e=>c._to===e._id));if(c._to_complete=e,""!=c.text&&""!=c.link){let t=await S(e._id);const a=/id=([^&]+)/,i=/p=([^&]+)/,n=(c.link.match(a),c.link.match(i));let s=t.find((e=>e._id===n[1]));s&&(c.procedure_notarial=u()(s.date).locale("es").format("LL")+" - "+s.notarialAct.name)}s.push(c)}e.sort(((e,t)=>e.created_at-t.created_at)),r(e)},S=async e=>{const t=await n.a.get("/api/procedurenotarial/"+e);return 200==t.status?t.data:[]};return Object(i.useEffect)((()=>{v(),t(!0),setTimeout((()=>{t(!1)}),2e3)}),[]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(p,{notification:j,data:o,setData:d,callback:()=>{v(),d(null)}}),Object(x.jsxs)(s.a,{loader:e,classNameMain:"mainTable",children:[Object(x.jsx)(f.a,{title:"Notifcaciones"}),Object(x.jsxs)("div",{className:"header-page",children:[Object(x.jsxs)("div",{className:"title-btn",children:[Object(x.jsx)("h6",{children:"A continuaci\xf3n encontrar\xe1s todas tus notificaciones"}),Object(x.jsx)(b.a,{size:"large",className:"btn-create",type:"primary",onClick:()=>(m(null),void d({})),children:"Crear"})]}),Object(x.jsx)("div",{className:"main-card card",children:Object(x.jsx)("div",{className:"main-card-table",children:Object(x.jsx)(c.a,{columns:O,data:a,pagination:{position:["bottomCenter"]}})})})]})]})]})}}}]);
//# sourceMappingURL=14.3ed0f0b0.chunk.js.map